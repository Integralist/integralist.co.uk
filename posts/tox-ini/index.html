<!DOCTYPE HTML>
<!--
	Editorial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
  <head>
    <title>Integralist</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="../../assets/css/main.css" />
  </head>
  <body class="is-preload">
    <!-- Wrapper -->
    <div id="wrapper">
      <!-- Main -->
      <div id="main">
        <div class="inner">
          <!-- Header -->
					<header id="header">
						<a href="../../index.html" class="logo"><strong>Home</strong></a>
							<ul class="icons">
							<!--<li><a href="https://x.com/integralist" class="icon brands fa-twitter" target="blank"><span class="label">Twitter</span></a></li>-->
							<!--<li><a href="https://instagram.com/wwfsuperstarsofwrestling" class="icon brands fa-instagram" target="blank"><span class="label">Instagram</span></a></li>-->
						</ul>
					</header>

          <!-- Content -->
          <section>
						<!--
            <header class="main">
              <h1>Royal Rumble 1989</h1>
              <p>A Bizarre Spectacle Where the Madness Multiplies</p>
            </header>
            <span class="image main"><img src="../images/rumble-89.jpg" alt="" /></span>
						-->
						<nav>

<ul>
<li><a href="#understanding-the-purpose-of-tox-ini">Understanding the purpose of tox.ini</a>
<ul>
<li><a href="#introduction">Introduction</a></li>

<li><a href="#what-is-tox">What is tox?</a></li>

<li><a href="#example-tox-ini">Example tox.ini</a></li>

<li><a href="#configuring-other-packages">Configuring <em>other</em> packages</a></li>

<li><a href="#why-do-multiple-tools-support-tox-ini">Why do multiple tools support <code>tox.ini</code>?</a></li>

<li><a href="#bonus-section">Bonus Section</a></li>
</ul></li>
</ul>

</nav>

<h1 id="understanding-the-purpose-of-tox-ini">Understanding the purpose of tox.ini</h1>

<h2 id="introduction">Introduction</h2>

<p>I was confused by the Python tool <a href="https://tox.readthedocs.io/en/latest/" target="_blank">tox</a> for a long time, and was unsure what it was really used for considering lots of different Python packages appeared to rely on tox&rsquo;s configuration file (e.g. <code>tox.ini</code>).</p>

<p>In this post I&rsquo;m going to briefly explain what the tox tool is, and what a <code>tox.ini</code> configuration file looks like and why that configuration file can be used for more than just serving the purposes of the tox tool.</p>

<h2 id="what-is-tox">What is tox?</h2>

<p>Tox is a tool that creates <a href="/posts/python-management/#virtual-environments">virtual environments</a>, and installs the configured dependencies for those environments, for the purpose of testing a Python package (i.e. something that will be shared via <a href="https://pypi.org/" target="_blank">PyPi</a>, and so it only works with code that defines a <code>setup.py</code>).</p>

<blockquote>
<p>PyPi == Python Package Index (i.e. where you <em>typically</em> install all your Python packages from, when executing <code>pip install</code>).</p>
</blockquote>

<p>The file that you use to configure tox can be one of the following&hellip;</p>

<ul>
<li><code>tox.ini</code></li>
<li><code>pyproject.toml</code> (see <a href="https://www.python.org/dev/peps/pep-0518/" target="_blank">PEP 518</a>)</li>
<li><code>setup.cfg</code> (see <a href="https://packaging.python.org/guides/distributing-packages-using-setuptools/" target="_blank">official guide to distributing packages</a>)</li>
</ul>

<blockquote>
<p>Note: these ^^ are all <a href="https://en.wikipedia.org/wiki/INI_file" target="_blank">ini file</a> formats &ndash; which is information that will become more relevant/important later on.</p>
</blockquote>

<h2 id="example-tox-ini">Example tox.ini</h2>

<p>All configuration options for tox can be found here: <a href="https://tox.readthedocs.io/en/latest/config.html" target="_blank">tox.readthedocs.io/en/latest/config.html</a> but the below example is a simple demonstration of how you might configure tox for a real package (e.g. this is an <em>actual</em> <code>tox.ini</code> file I&rsquo;ve used).</p>

<pre><code class="language-ini">[tox]
envlist = 
    py37, lint
toxworkdir = 
    {env:TOX_WORK_DIR}

[testenv]
setenv =
    PYTHONDONTWRITEBYTECODE = 1
whitelist_externals =
    /bin/bash
deps = 
    -rrequirements-dev.txt
commands =
    py.test --cov={envsitepackagesdir}/bf_tornado -m &quot;not integration&quot;

[testenv:dev]
usedevelop=True
recreate = False
commands =
    # to run arbitrary commands: tox -e dev -- bash
    {posargs:py.test --cov=bf_tornado}

[testenv:lint]
deps =
    flake8==3.8.3
    mypy==0.782
commands =
    flake8 bf_tornado
    mypy --verbose --ignore-missing-imports --package bf_tornado
</code></pre>

<blockquote>
<p>Note: the name after <code>testenv:</code> is the <em>name</em> of the virtual environment that will be created (e.g. <code>testenv:foo</code> will create a &ldquo;foo&rdquo; virtual environment).</p>
</blockquote>

<h2 id="configuring-other-packages">Configuring <em>other</em> packages</h2>

<p>A <code>tox.ini</code> file can be used to configure different types of packages, which is confusing at first because the tox home page suggests that tox is used to test <em>your own</em> packages you plan on distributing to PyPi.</p>

<p>What the tox authors mean by that description, is that the <code>tox</code> <em>command</em> itself is used to handle testing your packages, while the <code>tox.ini</code> <em>configuration file</em> is just one such file that can be used to contain configuration information.</p>

<p>This is why other packages, such as <a href="https://flake8.pycqa.org/en/latest/index.html" target="_blank">Flake8</a> allow you to <a href="https://flake8.pycqa.org/en/latest/user/configuration.html" target="_blank">configure Flake8</a> using the <code>tox.ini</code> file, as well as alternatives such as: <code>setup.cfg</code> or <code>.flake8</code>.</p>

<p>The key to understanding why this works is as follows: each of these files conform to the <a href="https://en.wikipedia.org/wiki/INI_file" target="_blank">ini file</a> format. So you&rsquo;re free to use whatever file <em>name</em> you feel best suits your project, while the format of the file will stay consistent to what is expected of an <code>.ini</code> file.</p>

<h2 id="why-do-multiple-tools-support-tox-ini">Why do multiple tools support <code>tox.ini</code>?</h2>

<p>The benefit of these various tools supporting the <code>tox.ini</code> filename specifically is to help reduce the number of configuration files a project requires.</p>

<p>Imagine you needed a unique configuration file for every Python command line tool you use in your project. How many would that result in? How hard would it be to remember all the various file names?</p>

<p>With that in mind, below is an example that shows various Python packages being configured within a <code>tox.ini</code> file.</p>

<p>And in case it&rsquo;s unclear, the configuration inside of the <code>tox.ini</code> file is used instead of having to pass those configuration values via the command line.</p>

<p>So in the case of a tool such as <code>flake8</code>, instead of using <code>flake8 --max-line-length=120</code> you could just call <code>flake8</code> and the flag value is extracted from the configuration file.</p>

<pre><code class="language-ini">[flake8]
max_line_length = 120
ignore = E261,E265,E402  # http://pep8.readthedocs.org/en/latest/intro.html#error-codes

[coverage:run]
branch = True

[coverage:report]
show_missing = True
exclude_lines =
    raise NotImplementedError
    return NotImplemented
    def __repr__
omit = bf_tornado/testing.py

[pytest]
addopts = 
    --strict -p no:cacheprovider --showlocals
markers =
    integration: mark a test as an integration test that makes http calls.
</code></pre>

<h2 id="bonus-section">Bonus Section</h2>

<p>Although not directly related to the conversation about <code>tox.ini</code> I thought it worth mentioning that I discovered recently the Python logging library allows you to be able to configure logging via an ini configuration file!</p>

<blockquote>
<p>Reference: <a href="https://docs.python.org/3/howto/logging.html#configuring-logging" target="_blank">docs.python.org/3/howto/logging.html</a></p>
</blockquote>

<p>The ini file might look something like the following:</p>

<pre><code>[loggers]
keys=root,simpleExample

[handlers]
keys=consoleHandler

[formatters]
keys=simpleFormatter

[logger_root]
level=DEBUG
handlers=consoleHandler

[logger_simpleExample]
level=DEBUG
handlers=consoleHandler
qualname=simpleExample
propagate=0

[handler_consoleHandler]
class=StreamHandler
level=DEBUG
formatter=simpleFormatter
args=(sys.stdout,)

[formatter_simpleFormatter]
format=%(asctime)s - %(name)s - %(levelname)s - %(message)s
datefmt=
</code></pre>

<p>The Python program that uses this file might look like the following:</p>

<pre><code>import logging
import logging.config

logging.config.fileConfig('logging.conf')

# create logger
logger = logging.getLogger('simpleExample')

# 'application' code
logger.debug('debug message')
logger.info('info message')
logger.warning('warn message')
logger.error('error message')
logger.critical('critical message')
</code></pre>

<p>Notice though, the <em>name</em> of the configuration file we imported was <code>logging.conf</code> (no <code>.ini</code> extension). It doesn&rsquo;t matter that the file doesn&rsquo;t use the <code>.ini</code> extension as long as the format of the file itself conforms to the ini format.</p>

          </section>
        </div>
      </div>
      <!-- Sidebar -->
<div id="sidebar">
  <div class="inner">
    <!-- Search -->
    <!--<section id="search" class="alt">-->
    <!--  <form method="post" action="#">-->
    <!--    <input type="text" name="query" id="query" placeholder="Search" />-->
    <!--  </form>-->
    <!--</section>-->
    <!-- Menu -->
    <nav id="menu">
      <header class="major">
        <h2>Menu</h2>
      </header>
      <ul>
        <li><a href="../../index.html">About</a></li>
        <!--<li><a href="../resume/index.html">Resume</a></li>-->
				
      </ul>
    </nav>
    <!-- Section -->
		<!--
    <section>
      <header class="major">
        <h2>Highlights</h2>
      </header>
      <div class="mini-posts">
        <article>
          <a href="ppv-survivorseries-88.html" class="image"><img src="../images/survivor-88-index.jpg" alt="" /></a>
          <p>Get ready for the ultimate showdown as Survivor Series 1988 brings non-stop tag team action, fierce rivalries, and unforgettable battles between the biggest WWF superstars!</p>
        </article>
        <article>
          <a href="ppv-royalrumble-89.html" class="image"><img src="../images/rumble-89-index.jpg" alt="" /></a>
          <p>Royal Rumble 1989 unleashes chaos with 30 superstars battling for glory in an unforgettable over-the-top-rope showdown!</p>
        </article>
        <article>
          <a href="ppv-summerslam-88.html" class="image"><img src="../images/slam-88-index.jpg" alt="" /></a>
          <p>SummerSlam 1988 delivers explosive action with iconic matchups, as the WWF's biggest stars collide in the hottest event of the summer!</p>
        </article>
      </div>
    </section>
		-->
    <!-- Section -->
    <!--<section>-->
    <!--  <header class="major">-->
    <!--    <h2>Get in touch</h2>-->
    <!--  </header>-->
    <!--  <p>Sed varius enim lorem ullamcorper dolore aliquam aenean ornare velit lacus, ac varius enim lorem ullamcorper dolore. Proin sed aliquam facilisis ante interdum. Sed nulla amet lorem feugiat tempus aliquam.</p>-->
    <!--  <ul class="contact">-->
    <!--    <li class="icon solid fa-envelope"><a href="#">information@untitled.tld</a></li>-->
    <!--    <li class="icon solid fa-phone">(000) 000-0000</li>-->
    <!--    <li class="icon solid fa-home">1234 Somewhere Road #8254<br />-->
    <!--      Nashville, TN 00000-0000</li>-->
    <!--  </ul>-->
    <!--</section>-->
    <!-- Footer -->
    <footer id="footer">
      <p class="copyright">&copy; Integralist. All rights reserved.</p>
      <p class="copyright small">Demo Images: <a href="https://unsplash.com">Unsplash</a>. Design: <a href="https://html5up.net">HTML5 UP</a>.</p>
    </footer>
  </div>
</div>

    </div>
    <!-- Scripts -->
    <script src="../../assets/js/jquery.min.js"></script>
    <script src="../../assets/js/browser.min.js"></script>
    <script src="../../assets/js/breakpoints.min.js"></script>
    <script src="../../assets/js/util.js"></script>
    <script src="../../assets/js/main.js"></script>

		<!-- The following script is for handling the automatic TOC generated by `make build` -->
		<script>
		// Get references to the elements
		const nav = document.querySelector('#main nav');
		const h1 = document.querySelector('#main h1');

		// Move the `nav` element to be underneath the `h1`
		h1.insertAdjacentElement('afterend', nav);

		// Hide the `nav` element by default using inline styles
		nav.style.display = 'none';

		// Create a new `h2` element with the text "TOC"
		const toc = document.createElement('h2');
		toc.textContent = 'TOC';
		toc.className = "toc"

		// Add inline styles to make the `h2` look clickable
		// DISABLED: done with className
		//
		// toc.style.cursor = 'pointer';
		// toc.style.color = 'blue';
		// toc.style.textDecoration = 'underline';

		// Add a click event listener to toggle the visibility of the `nav`
		toc.addEventListener('click', () => {
				nav.style.display = nav.style.display === 'none' ? 'block' : 'none';
		});

		// Insert the `h2` element above the `nav`
		nav.insertAdjacentElement('beforebegin', toc);
		</script>
  </body>
</html>
